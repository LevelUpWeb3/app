{
  "id": "swapping",
  "name": "Swap",
  "index": 2,
  "level": 2,
  "website": "https://github.com/LevelUpWeb3/ERC20-Mission",
  "summary": "Introduction to implementing a basic swapping contract by understanding Uniswap V2 router.",
  "heroImage": "/images/level-up-preview.png",
  "labels": [
    "Defi"
  ],
  "content": {
    "compiledSource": "/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsxDEV: _jsxDEV} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    h2: \"h2\",\n    ul: \"ul\",\n    li: \"li\",\n    h3: \"h3\",\n    ol: \"ol\",\n    code: \"code\",\n    pre: \"pre\",\n    a: \"a\"\n  }, _provideComponents(), props.components), {ContentCopy} = _components;\n  if (!ContentCopy) _missingMdxReference(\"ContentCopy\", true, \"8:1-33:26\");\n  return _jsxDEV(_Fragment, {\n    children: [_jsxDEV(_components.h1, {\n      children: \"Swap\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 4,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.p, {\n      children: \"In this challenge, you'll implement a basic Uniswap V2-based swapping contract.\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 6,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(ContentCopy, {\n      code: `// SPDX-License-Identifier: MIT\npragma solidity ^0.8.24;\n\ncontract Swap {\n    // Provide the Uniswap V2 router address and the WETH address\n\n    // Define the constructor\n    constructor(...) {\n        // Initialize the addresses\n    }\n\n    // Create a swap function that takes input and output token addresses,\n    // the input amount, the minimum output amount, and the recipient's address\n    function swap(\n        ...\n    ) external {\n        // Transfer the input tokens from the sender to the contract\n\n        // Approve the Uniswap router to spend the input tokens\n\n        // Define the swapping path: directly between the tokens if either is WETH,\n        // or through WETH otherwise\n\n        // Call the Uniswap router's swapExactTokensForTokens function to execute the swap\n    }\n}`,\n      language: \"solidity\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 8,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.h2, {\n      children: \"Constant Product Formula\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 35,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.p, {\n      children: \"The constant product formula is used to calculate how much token B will be received by a user who sends $a$ amount of token A:\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 37,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.p, {\n      children: \"$$ a \\\\cdot b = k $$\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 39,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.p, {\n      children: \"Here;\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 41,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ul, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"$a$ denotes the amount of token A,\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 43,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"$b$ denotes the amount of token B, and\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 44,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"$k$ is a constant (always).\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 45,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 43,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.h3, {\n      children: \"How does it work?\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 47,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.p, {\n      children: \"Let's say Alice wants to swap her 1 ETH to DAI.\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 49,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ol, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"Alice goes to ETH/DAI pool.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 51,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 51,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ul, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"For the sake of simplicity, let us assume there are 10 ETH and 25,000 DAI in the pool. Therefore\\n$$k = (10) \\\\times (25,000) = (250,000)$$.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 53,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 53,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ol, {\n      start: \"2\",\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"Alice sends her 1 ETH to the pool.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 56,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 56,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ul, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"Now, the pool has 11 ETH and 25,000 DAI.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 58,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"The pool sends such amount of DAI to Alice that $k$ remains constant.\\n$$(11) \\\\times (25,000 - amountDAI) = 250,000$$\\n$$amountDAI = 2,272.73$$.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 59,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 58,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ol, {\n      start: \"3\",\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"Alice receives 2,272.73 DAI for 1 ETH she had.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 63,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 63,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ul, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"Now the pool has 11 ETH and 22,727.27 DAI.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 65,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"If you multiply these two numbers, you get the same $k=250,000$.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 66,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 65,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.h2, {\n      children: [\"The Essence of the \", _jsxDEV(_components.code, {\n        children: \"swapExactTokensForTokens()\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 68,\n        columnNumber: 23\n      }, this)]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 68,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.pre, {\n      children: _jsxDEV(_components.code, {\n        className: \"language-solidity\",\n        children: \"function swapExactTokensForTokens(\\n  uint amountIn,\\n  uint amountOutMin,\\n  address[] calldata path,\\n  address to,\\n  uint deadline\\n) external returns (uint[] memory amounts) {\\n\\n}\\n\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 70,\n        columnNumber: 1\n      }, this)\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 70,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.p, {\n      children: \"Swaps an exact amount of input tokens for as many output tokens as possible, along the route determined by the path. The first element of path is the input token, the last is the output token, and any intermediate elements represent intermediate pairs to trade through (if, for example, a direct pair does not exist).\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 82,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.h2, {\n      children: \"Key Points\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 84,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ol, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"As you will use an external function from Uniswap V2 Router, you need to know what kind of new types are needed to implement.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 86,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"Be careful if you need an intermediary step when you build the swapping path (non-WETH case).\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 87,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 86,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.h2, {\n      children: \"Build the Contract\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 89,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ol, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: \"As you'll use Uniswap V2 Router, you need to define the contract address of it.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 91,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"For non-WETH cases, you'll need to add an intermediary step into the swapping path, so you need to define WETH address too.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 92,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: [\"Build the function:\\na. Recall from the ERC20 mission that you need token approval.\\nb. Define the swapping path.\\nc. Specify the conditional for the case where no token is WETH.\\nd. Call \", _jsxDEV(_components.code, {\n          children: \"swapExactTokensForTokens()\"\n        }, undefined, false, {\n          fileName: \"<source.js>\",\n          lineNumber: 97,\n          columnNumber: 12\n        }, this), \".\"]\n      }, undefined, true, {\n        fileName: \"<source.js>\",\n        lineNumber: 93,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"Define the needed interface for the router.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 98,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: \"Define the needed interface for WETH.\"\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 99,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 91,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.h2, {\n      children: \"Further Reading\"\n    }, undefined, false, {\n      fileName: \"<source.js>\",\n      lineNumber: 101,\n      columnNumber: 1\n    }, this), \"\\n\", _jsxDEV(_components.ol, {\n      children: [\"\\n\", _jsxDEV(_components.li, {\n        children: _jsxDEV(_components.a, {\n          href: \"https://medium.com/@arbnom/navigating-the-defi-landscape-a-comprehensive-deep-dive-to-amms-954020ec23b\",\n          children: \"A Comprehensive Deep Dive to AMMs\"\n        }, undefined, false, {\n          fileName: \"<source.js>\",\n          lineNumber: 103,\n          columnNumber: 4\n        }, this)\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 103,\n        columnNumber: 1\n      }, this), \"\\n\", _jsxDEV(_components.li, {\n        children: _jsxDEV(_components.a, {\n          href: \"https://docs.uniswap.org/contracts/v2/concepts/protocol-overview/how-uniswap-works\",\n          children: \"How Uniswap works\"\n        }, undefined, false, {\n          fileName: \"<source.js>\",\n          lineNumber: 104,\n          columnNumber: 4\n        }, this)\n      }, undefined, false, {\n        fileName: \"<source.js>\",\n        lineNumber: 104,\n        columnNumber: 1\n      }, this), \"\\n\"]\n    }, undefined, true, {\n      fileName: \"<source.js>\",\n      lineNumber: 103,\n      columnNumber: 1\n    }, this)]\n  }, undefined, true, {\n    fileName: \"<source.js>\",\n    lineNumber: 1,\n    columnNumber: 1\n  }, this);\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsxDEV(MDXLayout, Object.assign({}, props, {\n    children: _jsxDEV(_createMdxContent, props, undefined, false, {\n      fileName: \"<source.js>\"\n    }, this)\n  }), undefined, false, {\n    fileName: \"<source.js>\"\n  }, this) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component, place) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\" + (place ? \"\\nItâ€™s referenced in your code at `\" + place + \"`\" : \"\"));\n}\n",
    "frontmatter": {},
    "scope": {}
  }
}